(()=>{"use strict";var e={1277:(e,t,n)=>{e.exports=n.p+"static/media/logo-rb.00c7db454dde4d25ede0.png"},7020:(e,t,n)=>{e.exports=n.p+"static/media/default-avatar.00c7db454dde4d25ede0.png"},8895:(e,t,n)=>{var o=n(3871),a=n(7486),r=n(9885),i=n(9017),s=n(4171),l=n(14),d=n(5118);const c={current:"dark",colors:{light:{background:"#fff",text:"#000",border:"#ccc"},dark:{background:"#000",text:"#fff",border:"#666"}}},u=(0,d.combineReducers)({theme:(e=c,t)=>"SET_THEME"===t.type?Object.assign({},e,{current:t.payload}):e}),f=(0,d.createStore)(u);var h=n(176),g=n(3938),m=n(7737),w=n(4598);const y=w.default.create({container:{flex:1,padding:20},title:{fontSize:24,fontWeight:"bold",marginBottom:20},subtitle:{fontSize:18,marginBottom:10}});var p=n(7182);function x({navigation:e}){const t=(0,l.useDispatch)(),{current:n,colors:o}=(0,l.useSelector)((e=>e.theme)),a=o[n];return(0,p.jsxs)(h.default,{style:[y.container,{backgroundColor:a.background}],children:[(0,p.jsx)(g.default,{style:[y.title,{color:a.text}],children:"Settings"}),(0,p.jsx)(m.default,{title:"Dark Theme",onPress:()=>{t((e=>({type:"SET_THEME",payload:e}))("dark"))}}),(0,p.jsxs)(g.default,{style:{color:a.text,marginTop:10},children:["Current Theme: ",n]}),(0,p.jsx)(m.default,{title:"Go Back",onPress:()=>e.goBack()})]})}var j=n(6542),S=n(1663);const b="https://www.sigmaltd.space",C=b+"/api",v=async()=>{const e=await(async()=>await S.default.getItem("token"))();return e&&"undefined"!==e&&"null"!==e?{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}:(console.warn("Token is empty or invalid:",e),{"Content-Type":"application/json"})},k={init:async()=>{console.log("Database initialized (API mode with JWT)")},register:async({email:e,password:t,realName:n,group:o,displayedName:a})=>{const r=await fetch(`${C}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,realName:n,group:o,displayedName:a})});if(!r.ok)throw new Error(await r.text());const i=await r.json();return await S.default.setItem("token",i.token),i.user},login:async({email:e,password:t})=>{const n=await fetch(`${C}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!n.ok)throw new Error(await n.text());const o=await n.json();return await S.default.setItem("token",o.token),o.user},logout:async()=>{await S.default.removeItem("token");const e=await fetch(`${C}/logout`,{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(await e.text());return await e.json()},getCurrentUser:async()=>{const e=await fetch(`${C}/current-user`,{headers:await v()});if(!e.ok)throw new Error(await e.text());return await e.json()},getUser:async e=>{const t=await fetch(`${C}/user/${e}`,{headers:await v()});if(!t.ok)throw new Error(await t.text());return await t.json()},getUsername:async e=>{const t=await k.getCurrentUser();return e&&e(t.displayedName),t.idUser},changeUsername:async e=>{const t=await fetch(`${C}/current-user`,{method:"POST",headers:await v(),body:JSON.stringify({username:e})});if(!t.ok)throw new Error(await t.text());return await t.json()},changeImage:async e=>{const t=await fetch(`${C}/current-user`,{method:"POST",headers:await v(),body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return await t.json()},addPost:async e=>{try{const t=await fetch(`${C}/posts`,{method:"POST",headers:await v(),body:JSON.stringify(e)}),n=await t.text();if(!t.ok)throw console.error("Post error response:",n),new Error(n||"Failed to upload post");return JSON.parse(n)}catch(t){throw console.error("Network error:",t),t}},getAllPosts:async e=>{const t=await fetch(`${C}/posts?page=${e}&pageSize=10`,{headers:await v()});if(!t.ok)throw new Error(await t.text());return await t.json()},getPost:async e=>{const t=await fetch(`${C}/post/${e}`,{headers:await v()});if(!t.ok)throw new Error(await t.text());return await t.json()},deletePost:async e=>{const t=await fetch(`${C}/posts`,{method:"DELETE",headers:await v(),body:JSON.stringify({postId:e})});if(!t.ok)throw new Error(await t.text());return await t.json()},getFollowingPosts:async e=>{const t=await fetch(`${C}/following-posts?page=${e}&pageSize=10`,{headers:await v()});if(!t.ok)throw new Error(await t.text());return await t.json()},getAllComments:async e=>{const t=await fetch(`${C}/comments?page=${e}&pageSize=10`,{headers:await v()});if(!t.ok)throw new Error(await t.text());return await t.json()},getPostComments:async e=>{const t=await fetch(`${C}/post/${e}/comments`,{headers:await v()});if(!t.ok)throw new Error(await t.text());return await t.json()},getPostCommentsCount:async e=>{const t=await fetch(`${C}/post/${e}/comments-count`,{headers:await v()});if(!t.ok)throw new Error(await t.text());return await t.json()},addComment:async({postId:e,content:t})=>{const n=await fetch(`${C}/comments`,{method:"POST",headers:await v(),body:JSON.stringify({postId:e,content:t})});if(!n.ok)throw new Error(await n.text());return await n.json()},likePost:async e=>{const t=await fetch(`${C}/like-post`,{method:"POST",headers:await v(),body:JSON.stringify({postId:e})});if(!t.ok)throw new Error(await t.text());return await t.json()},getLikePost:async e=>{const t=await fetch(`${C}/like-post?idPost=${e}`,{method:"GET",headers:await v()});if(!t.ok)throw new Error(await t.text());return await t.json()},unlikePost:async e=>{const t=await fetch(`${C}/unlike-post`,{method:"POST",headers:await v(),body:JSON.stringify({postId:e})});if(!t.ok)throw new Error(await t.text());return await t.json()},getCommentLikes:async e=>{const t=await fetch(`${C}/get-comment-likes`,{method:"POST",headers:await v(),body:JSON.stringify({commentId:e})});if(!t.ok)throw new Error(await t.text());return await t.json()},likeComment:async e=>{const t=await fetch(`${C}/like-comment`,{method:"POST",headers:await v(),body:JSON.stringify({commentId:e})});if(!t.ok)throw new Error(await t.text());return await t.json()},unlikeComment:async e=>{const t=await fetch(`${C}/unlike-comment`,{method:"POST",headers:await v(),body:JSON.stringify({commentId:e})});if(!t.ok)throw new Error(await t.text());return await t.json()},followTag:async e=>{const t=await fetch(`${C}/follow-tag`,{method:"POST",headers:await v(),body:JSON.stringify({tagName:e})});if(!t.ok)throw new Error(await t.text());return await t.json()},unfollowTag:async e=>{const t=await fetch(`${C}/unfollow-tag`,{method:"POST",headers:await v(),body:JSON.stringify({tagName:e})});if(!t.ok)throw new Error(await t.text());return await t.json()},getFollowedTags:async()=>{const e=await fetch(`${C}/followed-tags`,{headers:await v()});if(!e.ok)throw new Error(await e.text());return await e.json()},addCommentBase64:async({postId:e,content:t,isAnonymous:n,imageBase64:o})=>{const a=await S.default.getItem("token"),r={postId:e,content:t,isAnonymous:n,imageBase64:o},i=await fetch(`${C}/comments`,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!i.ok)throw new Error(await i.text());return await i.json()}};k.init();const P=k,I=w.default.create({container:{flex:1,justifyContent:"center",padding:20},title:{fontSize:24,fontWeight:"bold",textAlign:"center",marginBottom:20},input:{borderWidth:1,padding:10,marginBottom:10,borderRadius:5},error:{color:"red",textAlign:"center",marginBottom:10}});var T=n(7880);function E({navigation:e}){const{current:t,colors:n}=(0,l.useSelector)((e=>e.theme)),o=n[t],[r,i]=(0,a.useState)(!0),[s,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[f,w]=(0,a.useState)(""),[y,x]=(0,a.useState)(""),[b,C]=(0,a.useState)(""),[v,k]=(0,a.useState)(null),[E,R]=(0,a.useState)(!1);(0,a.useEffect)((()=>{!async function(){await S.default.getItem("token")&&e.replace("Main")}();const t=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),o="standalone"in window.navigator&&window.navigator.standalone;t&&n&&!o&&R(!0)}),[]);return(0,p.jsxs)(h.default,{style:[I.container,{backgroundColor:o.background}],children:[(0,p.jsx)(g.default,{style:[I.title,{color:o.text}],children:r?"Login":"Sign Up"}),v&&(0,p.jsx)(g.default,{style:I.error,children:v}),(0,p.jsx)(j.default,{style:[I.input,{borderColor:o.border,color:o.text}],placeholder:"Email",value:s,onChangeText:d,autoCapitalize:"none",placeholderTextColor:"#000"===o.text?"#666":"#ccc"}),(0,p.jsx)(j.default,{style:[I.input,{borderColor:o.border,color:o.text}],placeholder:"Password",value:c,onChangeText:u,secureTextEntry:!0,placeholderTextColor:"#000"===o.text?"#666":"#ccc"}),!r&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(j.default,{style:[I.input,{borderColor:o.border,color:o.text}],placeholder:"Real Name",value:f,onChangeText:w,placeholderTextColor:"#000"===o.text?"#666":"#ccc"}),(0,p.jsx)(j.default,{style:[I.input,{borderColor:o.border,color:o.text}],placeholder:"Group (e.g., student)",value:y,onChangeText:x,placeholderTextColor:"#000"===o.text?"#666":"#ccc"}),(0,p.jsx)(j.default,{style:[I.input,{borderColor:o.border,color:o.text}],placeholder:"Displayed Name",value:b,onChangeText:C,placeholderTextColor:"#000"===o.text?"#666":"#ccc"})]}),(0,p.jsx)(m.default,{title:r?"Login":"Sign Up",onPress:async()=>{k(null);try{let t;r?t=await P.login({email:s,password:c}):c.length>7&&b.length>1?t=await P.register({email:s,password:c,realName:f,group:y,displayedName:b}):alert("Password or Displayed Name Too Short!"),e.replace("Main")}catch(t){k(t.message),console.error("Auth error:",t.message)}}}),(0,p.jsx)(m.default,{title:"Switch to "+(r?"Sign Up":"Login"),onPress:()=>{i(!r),k(null),d(""),u(""),w(""),x(""),C("")}}),(0,p.jsx)(T.default,{visible:E,style:{backgroundColor:"#111"},children:(0,p.jsxs)(h.default,{style:{alignItems:"center",alignSelf:"center",alignContent:"center"},children:[(0,p.jsx)(g.default,{style:{color:"#fff",fontSize:20,alignSelf:"center",alignItems:"center",alignContent:"center",justifyContent:"center"},children:'\u041d\u0430\u0436\u043c\u0438 \u043d\u0430 \u043a\u043d\u043e\u043f\u043a\u0443 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f, \u043f\u043e\u0442\u043e\u043c \u0432\u044b\u0431\u0435\u0440\u0438 "Add to Home Screen" \u0447\u0442\u043e\u0431\u044b \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c'}),(0,p.jsx)(m.default,{title:"Got it",onPress:()=>R(!1)})]})})]})}var R=n(8103),L=n(6722),F=n(269),z=n(4034),B=n(2704),O=n(3094),$=n(6557),N=n(7621),A=n(4139),D=n(4276);const M=w.default.create({container:{flex:1,padding:10,width:"100%"},title:{fontSize:24,fontWeight:"bold",marginBottom:10},input:{borderWidth:1,padding:10,marginBottom:10,borderRadius:5},previewImage:{width:100,height:100,marginRight:10,marginBottom:10},error:{color:"red",marginBottom:10},postList:{marginTop:10},post:{marginBottom:10}});var W=n(3757);const U=({onPress:e,visible:t})=>{const n=(0,a.useRef)(new W.default.Value(0)).current;return(0,a.useEffect)((()=>{W.default.timing(n,{toValue:t?0:300,duration:500,useNativeDriver:!0}).start()}),[t,n]),(0,p.jsx)(W.default.View,{style:{position:"absolute",top:.85*B.default.get("window").height,right:.02*B.default.get("window").width,zIndex:999,transform:[{translateY:n}]},children:(0,p.jsx)(N.default,{style:{backgroundColor:"#000",alignItems:"center",justifyContent:"center",padding:10,borderRadius:50,width:60,height:60},onPress:e,children:(0,p.jsx)(g.default,{style:{fontSize:30,color:"#FFF"},children:"\u03c3"})})})};var H=n(4833),V=n(9162),J=n(9120),_=n(485);function G({tag:e,onRefresh:t}){const n=(0,l.useSelector)((e=>e.theme)),[o,r]=(0,a.useState)(!1);(0,a.useEffect)((()=>{P.getFollowedTags().then((t=>r(t.includes(e))))}),[e]);return(0,p.jsx)(N.default,{onPress:async()=>{try{o?await P.unfollowTag(e):await P.followTag(e),r(!o),t(o)}catch(n){console.error("Error toggling tag:",n)}},style:{marginRight:5,backgroundColor:"#BBB",borderRadius:10,padding:5,alignContent:"center",height:"100%"},children:(0,p.jsx)(g.default,{style:{color:o?n.colors.text:"#888",fontWeight:o?"bold":"normal",textAlign:"center",textAlignVertical:"center",alignContent:"center",alignSelf:"center",alignItems:"center"},children:e.substring(0,20)||"unknown"})})}const{width:q}=B.default.get("window");const Z=w.default.create({container:{maxWidth:660,width:.9*B.default.get("window").width,marginVertical:8,borderRadius:12,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},header:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:12,borderBottomWidth:1,borderBottomColor:"rgba(255,255,255,0.1)"},userInfo:{flexDirection:"row",alignItems:"center"},avatar:{marginRight:12,borderWidth:2,borderColor:"#fff"},username:{color:"#fff",fontSize:16,fontWeight:"600"},timestamp:{color:"#aaa",fontSize:12,marginTop:2},mediaScroll:{width:"100%",padding:0,alignSelf:"center",flex:1},mediaScrollContent:{flexDirection:"row",padding:0},mediaContainer:{alignItems:"center",justifyContent:"center",width:q,maxWidth:660},media:{width:q,height:q,maxWidth:660,maxHeight:660,overflow:"hidden"},pagination:{position:"absolute",bottom:10,flexDirection:"row",alignSelf:"center"},dot:{height:8,width:8,borderRadius:4,margin:4},contentContainer:{padding:12},content:{color:"#fff",fontSize:14,lineHeight:20},actions:{flexDirection:"row",padding:12,borderTopWidth:1,borderTopColor:"rgba(255,255,255,0.1)"},actionButton:{flexDirection:"row",alignItems:"center",marginRight:20},actionText:{color:"#fff",marginLeft:8,fontSize:14},tagsContainer:{paddingHorizontal:12,paddingBottom:12},tag:{color:"#4CAF50",marginRight:8,fontSize:14}}),Y=({navigation:e,post:t,refresher:o})=>{const r=(0,l.useSelector)((e=>e.theme)),[i,s]=(0,a.useState)(t.likedByCurrentUser||!1),[d,c]=(0,a.useState)({displayedName:"Loading...",pic:null}),[u,f]=(0,a.useState)(!1),[m,w]=(0,a.useState)(!0),[y,x]=(0,a.useState)(0),[j,S]=(0,a.useState)(!1),C=(0,a.useRef)(null),[v,k]=(0,a.useState)(0),[I,E]=(0,a.useState)([]),[z,B]=(0,a.useState)("");(0,a.useEffect)((()=>{let e=!0;return(async()=>{try{w(!0);const[n,o]=await Promise.all([P.getUser(t.createdByIdUser),P.getCurrentUser()]),a=await P.getLikePost(Number(t.idPost));s(a),e&&(c(n||{displayedName:"Unknown",pic:null}),f(o?.idUser===t.createdByIdUser));const r=await P.getPostCommentsCount(t.idPost);if(k(r.count),t.content){const e=t.content.match(/(https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&\/=]*))/gi)||[];E(e);let n=t.content;e.forEach((e=>{n=n.replace(e,`(${I.indexOf(e)+2})`)})),B(n)}}catch(n){console.error("Error fetching post data:",n)}finally{e&&w(!1)}})(),()=>{e=!1}}),[t.createdByIdUser,t.idPost]),(0,a.useEffect)((()=>{const e=setInterval((async()=>{await O()}),1e3);return()=>clearInterval(e)}),[]);const O=async()=>{const e=await P.getPostCommentsCount(t.idPost);k(e.count)};if(m)return(0,p.jsx)(h.default,{style:Z.container,children:(0,p.jsx)(F.default,{size:"large",color:r.colors.primary})});const $=Array.isArray(t.images)?t.images:t.images?.split(",").filter(Boolean)||[];return(0,p.jsxs)(h.default,{style:[Z.container,{backgroundColor:r.colors.background}],children:[(0,p.jsx)(T.default,{isVisible:j,children:(0,p.jsx)(L.default,{style:{width:"100%",height:"100%",resizeMode:"center"},source:d.pic?{uri:d.pic}:n(7020)})}),(0,p.jsxs)(h.default,{style:Z.header,children:[(0,p.jsxs)(h.default,{style:{flexDirection:"row",alignItems:"flex-start"},children:[(0,p.jsx)(J.Avatar,{source:d.pic?{uri:d.pic}:n(7020),rounded:!0,size:"medium",containerStyle:Z.avatar,onLongPress:()=>S(!0),onPressOut:()=>S(!1)}),(0,p.jsx)(N.default,{style:Z.userInfo,onPress:()=>e.navigate("UserProfile",{userId:t.createdByIdUser}),children:(0,p.jsxs)(h.default,{children:[(0,p.jsx)(g.default,{style:Z.username,children:t.isAnonymous?"Anonymous":d.displayedName}),(0,p.jsx)(g.default,{style:Z.timestamp,children:new Date(t.createdAt).toLocaleDateString()})]})})]}),t.tags?.length>0&&(0,p.jsx)(h.default,{style:Z.tagsContainer&&{flex:1},children:(0,p.jsx)(R.default,{style:{flexDirection:"row-reverse"},data:Array.isArray(t.tags)?t.tags.slice(0,4).reverse():t.tags.split(",").slice(0,4).reverse(),renderItem:({item:e})=>(0,p.jsx)(G,{tag:e}),horizontal:!0,showsHorizontalScrollIndicator:!1,keyExtractor:(e,t)=>`${e}-${t}`})}),u&&(0,p.jsx)(N.default,{onPress:async()=>{if(u)try{(await P.deletePost(t.idPost)).success&&o()}catch(e){console.error("Error deleting post:",e),alert("Failed to delete post")}else alert("You are not the creator")},children:(0,p.jsx)(_.default,{name:"trash-outline",size:24,color:"#ff4444"})})]}),z&&(0,p.jsx)(h.default,{style:Z.contentContainer,children:(0,p.jsx)(g.default,{style:Z.content,children:z})}),$.length>0&&(0,p.jsxs)(h.default,{children:[(0,p.jsx)(H.default,{ref:C,horizontal:!0,pagingEnabled:!0,showsHorizontalScrollIndicator:!1,scrollEventThrottle:1,onScroll:e=>{const t=Math.round((e.nativeEvent.contentOffset.x+100)/q);x(t)},style:Z.mediaScroll,contentContainerStyle:Z.mediaScrollContent,children:$.map(((e,t)=>(0,p.jsx)(h.default,{style:Z.mediaContainer,children:/\.(mp4|mov|m4v)$/.test(e)?(0,p.jsx)(V.Video,{source:{uri:`${b}${e}`},style:Z.media,resizeMode:"cover",shouldPlay:y===t,isLooping:!0,useNativeControls:!1,onError:e=>console.error("Video error:",e)}):(0,p.jsx)(L.default,{source:{uri:`${b}${e}`},style:Z.media,resizeMode:"cover",onError:e=>console.error("Image error:",e)})},`${e}-${t}`)))}),$.length>1&&(0,p.jsx)(h.default,{style:Z.pagination,children:$.map(((e,t)=>(0,p.jsx)(A.default,{onPress:()=>{C.current?.scrollTo({x:t*q,animated:!0}),x(t)},style:[Z.dot,{backgroundColor:t===y?"#fff":"rgba(255,255,255,0.5)"}]},t)))})]}),I.length>0&&(0,p.jsx)(h.default,{style:Z.actions,children:(0,p.jsx)(R.default,{data:I,renderItem:({item:e})=>(0,p.jsx)(h.default,{style:{width:80,height:25,backgroundColor:"#222",borderRadius:5,alignSelf:"center",alignItems:"center"},children:(0,p.jsx)("a",{href:e,style:{color:"#FFFFFF"},target:"_blank",children:e.slice(8,18)})}),horizontal:!0,showsHorizontalScrollIndicator:!1})}),(0,p.jsxs)(h.default,{style:Z.actions,children:[(0,p.jsxs)(N.default,{onPress:async()=>{try{i?(await P.unlikePost(t.idPost),s(!1),t.likes--):(await P.likePost(t.idPost),s(!0),t.likes++)}catch(e){console.error("Error handling like:",e)}},style:Z.actionButton,children:[(0,p.jsx)(_.default,{name:i?"heart":"heart-outline",size:28,color:i?"#ff4444":"#666"}),(0,p.jsx)(g.default,{style:Z.actionText,children:t.likes})]}),(0,p.jsxs)(N.default,{onPress:()=>e.navigate("PostDetail",{postId:t.idPost,navigation:e}),style:Z.actionButton,children:[(0,p.jsx)(_.default,{name:"chatbubble-outline",size:28,color:"#666"}),(0,p.jsx)(g.default,{style:Z.actionText,children:v})]})]})]})};class K extends a.Component{navigation=null;loader=null;constructor(e,t,n){super(e),this.navigation=t,this.loader=n,this.state={data:[],page:1,isLoading:!1,hasMore:!0},this.flatListRef=a.createRef()}componentDidMount(){this.fetchData()}fetchData=async()=>{if(!this.state.isLoading&&this.state.hasMore){this.setState({isLoading:!0});try{const e=(await this.loader(this.state.page)).posts||[];this.setState((t=>({data:1===t.page?e:[...t.data,...e],isLoading:!1,hasMore:e.length>0})))}catch(e){console.error("Error fetching posts:",e),'{"error":"Access denied, no valid Bearer token provided"}'===e.message&&(this.navigation.navigate("Login"),await S.default.removeItem("token")),this.setState({isLoading:!1})}}};handleLoadMore=()=>{!this.state.isLoading&&this.state.hasMore&&this.setState((e=>({page:e.page+1})),(()=>this.fetchData()))};handleScroll=e=>{const{contentOffset:t,contentSize:n,layoutMeasurement:o}=e.nativeEvent;n.height,t.y,o.height};renderRow=({item:e})=>(0,p.jsxs)(h.default,{style:{minHeight:50},children:[" ",(0,p.jsx)(Y,{post:e,navigation:this.navigation})]});renderList=()=>(0,p.jsx)(R.default,{ref:this.flatListRef,data:this.state.data,renderItem:this.renderRow,keyExtractor:(e,t)=>e.id?e.id.toString():t.toString(),onEndReached:this.handleLoadMore,onEndReachedThreshold:.1,style:{backgroundColor:"#000",flex:1,alignSelf:"center"},onScroll:this.handleScroll,ListFooterComponent:this.renderFooter,showsVerticalScrollIndicator:!1,contentContainerStyle:{flexGrow:1},extraData:this.state.page});renderFooter=()=>this.state.isLoading?(0,p.jsx)(h.default,{style:{padding:20},children:(0,p.jsx)(g.default,{children:"Loading more posts..."})}):null;renderEmpty=()=>this.state.isLoading?null:(0,p.jsx)(h.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,p.jsx)(g.default,{children:"No posts available"})});render(){return(0,p.jsxs)(D.default,{style:[M.container,{backgroundColor:"#000"}],children:[0===this.state.data.length?this.renderEmpty():this.renderList(),(0,p.jsx)(U,{onPress:()=>this.navigation.navigate("CreatePost"),visible:!0})]})}}class Q extends a.Component{constructor(e){super(e),this.state={navigation:e.navigation},this.flatListRef=a.createRef()}render(){const{navigation:e}=this.props;return(0,p.jsxs)(D.default,{style:[M.container,{backgroundColor:"#000"}],children:[(0,p.jsx)(K,{navigation:e,loader:P.getAllPosts}),(0,p.jsx)(U,{onPress:()=>e.navigate("CreatePost"),visible:!0})]})}}const X=(0,a.forwardRef)(((e,t)=>{class n extends a.Component{constructor(e){super(e),this.state={data:[],page:1,isLoading:!1,hasMore:!0,navigation:e.navigation,currentScreen:e.currentScreen},this.flatListRef=a.createRef()}componentDidMount(){this.fetchData()}fetchData=async()=>{if(!this.state.isLoading&&this.state.hasMore){this.setState({isLoading:!0});try{const e=(await P.getFollowingPosts(this.state.page)).posts||[];this.setState((t=>({data:1===t.page?e:[...t.data,...e],isLoading:!1,hasMore:e.length>0})))}catch(e){console.error("Error fetching posts:",e),'{"error":"Access denied, no valid Bearer token provided"}'===e.message&&(this.state.navigation.navigate("Login"),await S.default.removeItem("token")),this.setState({isLoading:!1})}}};handleLoadMore=()=>{!this.state.isLoading&&this.state.hasMore&&this.setState((e=>({page:e.page+1})),(()=>this.fetchData()))};handleScroll=e=>{const{contentOffset:t,contentSize:n,layoutMeasurement:o}=e.nativeEvent;n.height,t.y,o.height};renderRow=({item:e})=>(0,p.jsxs)(h.default,{style:{minHeight:50},children:[" ",(0,p.jsx)(Y,{post:e,navigation:this.props.navigation,currentScreen:this.props.currentScreen})]});renderList=()=>(0,p.jsx)(R.default,{ref:this.flatListRef,data:this.state.data,renderItem:this.renderRow,keyExtractor:(e,t)=>e.id?e.id.toString():t.toString(),onEndReached:this.handleLoadMore,onEndReachedThreshold:.1,style:{backgroundColor:"#000",flex:1,alignSelf:"center"},onScroll:this.handleScroll,ListFooterComponent:this.renderFooter,showsVerticalScrollIndicator:!1,contentContainerStyle:{flexGrow:1},extraData:this.state.page});renderFooter=()=>this.state.isLoading?(0,p.jsx)(h.default,{style:{padding:20},children:(0,p.jsx)(g.default,{children:"Loading more posts..."})}):null;renderEmpty=()=>this.state.isLoading?null:(0,p.jsx)(h.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,p.jsx)(g.default,{children:"No posts available"})});render(){const{navigation:e}=this.props;return(0,p.jsx)(h.default,{style:[M.container,{backgroundColor:"#000"}],children:0===this.state.data.length?this.renderEmpty():this.renderList()})}}const o=a.createRef();return a.useImperativeHandle(t,(()=>({fetchData:()=>o.current?.fetchData(),listRef:o.current?.flatListRef}))),(0,p.jsx)(n,Object.assign({ref:o},e))})),ee=w.default.create({container:{flex:1,padding:20,alignItems:"center"},header:{fontSize:24,fontWeight:"bold",marginBottom:20},menuItem:{padding:15,borderBottomWidth:1,borderBottomColor:"#ccc",width:"100%"}}),te=w.default.create({container:{padding:20,borderTopLeftRadius:10,borderTopRightRadius:10,maxHeight:"50%"},closeButton:{alignSelf:"flex-end",padding:10},header:{fontSize:24,fontWeight:"bold",marginBottom:20,textAlign:"center"},menuItem:{padding:15,borderBottomWidth:1,borderBottomColor:"#ccc"},image:{width:100,height:100,alignSelf:"center"}});function ne({navigation:e}){const t=(0,l.useSelector)((e=>e.theme)),[n,o]=(0,a.useState)(!1),[r,i]=(0,a.useState)(!1),[s,d]=(0,a.useState)([]),[c,u]=(0,a.useState)(""),[f,h]=(0,a.useState)({});(0,a.useEffect)((()=>{m()}),[]);const m=async()=>{const e=await P.getUsername(u),t=await P.getUser(e);h(t),d([{uri:t.pic}]),console.log(t)},w=async()=>{i(!0);const e=await O.launchImageLibraryAsync({mediaTypes:$.MediaTypeOptions.Images,allowsMultipleSelection:!1,quality:.7,allowsEditing:!0});if(!e.canceled){const t=e.assets.map((e=>({uri:e.uri,type:"image",mimeType:e.mimeType||"image/jpeg"===e.type})));console.log(t),d(t)}};return(0,p.jsxs)(D.default,{style:[te.container,{backgroundColor:t.colors.background}],children:[(0,p.jsx)(g.default,{style:[te.header,{color:"#fff",fontSize:18}],children:"Profile"}),(0,p.jsx)(J.Avatar,{rounded:!0,source:{uri:s.length>0?s[0].uri:s.uri},style:te.image}),n?(0,p.jsx)(j.default,{value:c,onChangeText:u,style:{borderWidth:1,padding:10,marginBottom:20,color:"#fff",borderColor:"#ccc",width:"100%"}}):(0,p.jsxs)(g.default,{style:{color:"#fff",marginBottom:20},children:["Username: ",c]}),(0,p.jsx)(N.default,{style:te.menuItem,onPress:async()=>{if(n)if(c.length>1){const e=await P.changeUsername(c);alert("Profile Updated",`Username saved as: ${e.displayedName}`)}else alert("Invalid length"),(0,a.useEffect)((()=>{P.getUsername(u)}),[]);o(!n)},children:(0,p.jsx)(g.default,{style:{color:"#fff"},children:n?"Save Profile":"Edit Profile"})}),(0,p.jsx)(N.default,{onPress:async()=>{if(console.log(s),r){const e={image:await Promise.all(s.map((async(e,t)=>{const n=await fetch(e.uri),o=await n.blob(),a=await new Promise((e=>{const t=new FileReader;t.onloadend=()=>e(t.result.split(",")[1]),t.readAsDataURL(o)})),r=e.mimeType?.split("/")[1]||"jpg";return{name:`${e.type}-${Date.now()}-${t}.${r}`,type:"image/jpeg",base64:a}})))},t=await P.changeImage(e);console.log(t),i(!1)}else await w()},style:te.menuItem,children:(0,p.jsx)(g.default,{style:{color:"#fff"},children:r?"Upload Picture":"Choose Profile Pic"})}),(0,p.jsx)(N.default,{style:te.menuItem,onPress:()=>{e.navigate("Settings"),onClose()},children:(0,p.jsx)(g.default,{style:{color:"#fff"},children:"Settings"})}),(0,p.jsx)(N.default,{style:te.menuItem,onPress:async()=>{try{await P.logout(),await e.navigate("Login")}catch(t){console.error("Logout error:",t)}},children:(0,p.jsx)(g.default,{style:{color:"#fff"},children:"Logout"})})]})}function oe({navigation:e}){const{current:t,colors:n}=(0,l.useSelector)((e=>e.theme)),o=n[t];return(0,p.jsxs)(h.default,{style:[ee.container,{backgroundColor:o.background}],children:[(0,p.jsx)(re,{navigation:e,header:!0}),(0,p.jsx)(ne,{navigation:e})]})}const ae=[{key:"Feed",component:Q,title:"Feed"},{key:"Following",component:X,title:"Following"}];function re({navigation:e,header:t,scrollToPage:n,activeScreen:o,setActiveScreen:r}){const[i,s]=(0,a.useState)(!1),l=()=>s(!0),d=()=>s(!1),c=(0,a.useCallback)(((e,t)=>{r(e),n(t)}),[n,r]);return(0,p.jsxs)(h.default,{children:[(0,p.jsxs)(T.default,{testID:"modal",deviceHeight:B.default.get("window").height,deviceWidth:B.default.get("window").width,animationIn:"slideInLeft",animationOut:"slideOutLeft",transparent:!0,isVisible:i,onRequestClose:d,style:{width:B.default.get("window").width,height:B.default.get("window").height,flexDirection:"row",margin:0},children:[(0,p.jsxs)(D.default,{style:{backgroundColor:"#000",width:.3*B.default.get("window").width,height:B.default.get("window").height,flexDirection:"column"},children:[(0,p.jsxs)(h.default,{style:{flex:3},children:[(0,p.jsx)(N.default,{onPress:()=>{d()},style:{marginTop:5,borderRadius:5,backgroundColor:"#222",height:30,width:.3*B.default.get("window").width,justifyContent:"center",alignItems:"center",maxWidth:200,alignSelf:"center"},children:(0,p.jsx)(g.default,{style:{color:"#FFF"},children:"Close"})}),(0,p.jsx)(N.default,{onPress:()=>{d(),e.navigate("Main"),e.navigate("ProfileSettings")},style:{marginTop:5,borderRadius:5,backgroundColor:"#111",height:50,width:.3*B.default.get("window").width,justifyContent:"center",alignItems:"center",alignSelf:"center",maxWidth:200},children:(0,p.jsx)(g.default,{style:{color:"#fff"},children:"Settings"})}),(0,p.jsx)(N.default,{onPress:()=>{d(),e.navigate("Main"),e.navigate("Profile")},style:{marginTop:5,borderRadius:5,backgroundColor:"#111",height:50,width:.3*B.default.get("window").width,justifyContent:"center",alignItems:"center",alignSelf:"center",maxWidth:200},children:(0,p.jsx)(g.default,{style:{color:"#fff"},children:"Profile"})})]}),(0,p.jsx)(h.default,{style:{flex:10}}),(0,p.jsxs)(h.default,{style:{flex:1,alignSelf:"center",alignItems:"center"},children:[(0,p.jsx)(g.default,{style:{color:"#FFF"},children:"SigmaLTD community"}),(0,p.jsx)(g.default,{style:{color:"#555"},children:"We trust in you"})]})]}),(0,p.jsx)(N.default,{style:{width:.7*B.default.get("window").width,height:B.default.get("window").height},onPress:d})]}),(0,p.jsx)(h.default,{style:{flexDirection:"row",backgroundColor:"#000",width:B.default.get("window").width},children:t?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(A.default,{style:{flex:2,alignItems:"center",alignSelf:"center",justifyContent:"center"},onPress:l,children:(0,p.jsx)(g.default,{style:{fontSize:30,color:"#FFF",fontWeight:"bold"},children:"\u03a3"})}),(0,p.jsx)(h.default,{style:{flex:20,alignItems:"center",alignSelf:"center",justifyContent:"center"}}),(0,p.jsx)(N.default,{onPress:e.goBack,style:{flex:2,justifyContent:"center",alignItems:"center",marginRight:5},children:(0,p.jsx)(g.default,{style:{color:"#FFF"},children:"Close"})})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(A.default,{style:{flex:2,alignItems:"center",alignSelf:"center",justifyContent:"center"},onPress:l,children:(0,p.jsx)(g.default,{style:{fontSize:30,color:"#FFF",fontWeight:"bold"},children:"\u03a3"})}),(0,p.jsx)(N.default,{style:{flex:10,alignItems:"center",justifyContent:"center"},onPress:()=>c("Feed",0),children:(0,p.jsx)(g.default,{style:{fontSize:"Feed"===o?20:16,fontWeight:"Feed"===o?"bold":"normal",color:"#FFF"},children:"Feed"})}),(0,p.jsx)(N.default,{style:{flex:10,alignItems:"center",justifyContent:"center"},onPress:()=>c("Following",1),children:(0,p.jsx)(g.default,{style:{fontSize:"Following"===o?20:16,fontWeight:"Following"===o?"bold":"normal",color:"#FFF"},children:"Following"})}),(0,p.jsx)(h.default,{style:{flex:2,alignItems:"center",alignSelf:"center",justifyContent:"center"}})]})})]})}const ie=function({navigation:e}){const t=(0,a.useRef)(null),[n,o]=(0,a.useState)("Feed");(0,a.useEffect)((()=>{e.addListener("focus",(()=>{o("Feed")}))}));const r=(0,a.useCallback)((e=>{t.current&&t.current.scrollToIndex({animated:!0,index:e})}),[]),i=(0,a.useCallback)(((e,t)=>({length:B.default.get("window").width,offset:B.default.get("window").width*t,index:t})),[]),s=(0,a.useCallback)((e=>{console.warn("Scroll to index failed:",e);new Promise((e=>setTimeout(e,500))).then((()=>{t.current?.scrollToIndex({index:e.index,animated:!0})}))}),[]),l=(0,a.useRef)(o);l.current=o;const d=(0,a.useRef)((({viewableItems:e})=>{if(e.length>0){const t=e[0].item;l.current(t.key)}})).current,c=(0,a.useRef)({itemVisiblePercentThreshold:50}).current;return(0,p.jsxs)(D.default,{style:{flex:1},children:[(0,p.jsx)(re,{navigation:e,scrollToPage:r,activeScreen:n,setActiveScreen:o}),(0,p.jsx)(R.default,{ref:t,data:ae,horizontal:!0,pagingEnabled:!0,showsHorizontalScrollIndicator:!1,renderItem:({item:t})=>(0,p.jsx)(h.default,{style:{width:B.default.get("window").width,height:B.default.get("window").height},children:(0,p.jsx)(t.component,{navigation:e,currentScreen:n===t.key,setActiveScreen:o})}),keyExtractor:e=>e.key,getItemLayout:i,onScrollToIndexFailed:s,initialNumToRender:1,maxToRenderPerBatch:1,windowSize:2,onViewableItemsChanged:d,viewabilityConfig:c})]})};function se({comment:e,currentUser:t,toggleLike:n}){const o=e.createdByIdUser===t.idUser,[r,i]=(0,a.useState)([]),[s,l]=(0,a.useState)(!1);(0,a.useEffect)((()=>{d()}));const d=async()=>{const n=await P.getCommentLikes(Number(e.idComment));i(n);let o=!0;n.forEach((e=>{e.idUser===t.idUser&&(l(!0),o=!1)})),o&&l(!1)};return(0,p.jsxs)(h.default,{style:[le.commentBubble,o?le.myComment:le.otherComment],children:[(0,p.jsx)(g.default,{style:le.author,children:e.displayedName}),(0,p.jsx)(g.default,{style:le.commentText,children:e.text}),e.images?.map(((e,t)=>(0,p.jsx)(L.default,{source:{uri:b+e},style:{width:200,height:200,marginTop:6,borderRadius:8},resizeMode:"cover"},t))),(0,p.jsx)(N.default,{onPress:()=>n(e),children:(0,p.jsxs)(g.default,{style:{color:s?"red":"#555"},children:["\u2764\ufe0f ",r.length||0]})})]})}const le=w.default.create({container:{flex:1,backgroundColor:"#fff"},centered:{justifyContent:"center",alignItems:"center"},commentsContainer:{padding:12},commentBubble:{marginBottom:10,padding:12,borderRadius:12,maxWidth:"90%"},myComment:{alignSelf:"flex-end",backgroundColor:"#d0f0c0"},otherComment:{alignSelf:"flex-start",backgroundColor:"#e6e6e6"},author:{fontWeight:"bold",color:"#333",marginBottom:4},commentText:{color:"#000",fontSize:15,marginBottom:4},inputContainer:{flexDirection:"row",padding:10,borderTopWidth:1,borderColor:"#ccc",backgroundColor:"#f9f9f9",alignItems:"center",flexWrap:"wrap"},textInput:{flex:1,borderColor:"#ccc",borderWidth:1,borderRadius:10,paddingHorizontal:12,paddingVertical:8,marginRight:10,fontSize:15,backgroundColor:"#fff",color:"#000"}});var de=n(5499);function ce({route:e}){const{current:t,colors:n}=(0,l.useSelector)((e=>e.theme))||{current:"light",colors:{light:{text:"#000",background:"#FFF"}}},o=n[t]||{text:"#000",background:"#FFF"},[r,i]=(0,a.useState)(null),[s,d]=(0,a.useState)([]),[c,u]=(0,a.useState)(!0),[f,m]=(0,a.useState)(""),[w,y]=(0,a.useState)(!1),[x,S]=(0,a.useState)([]),[b,C]=(0,a.useState)(null),v=(0,a.useRef)(null),[k,I]=(0,a.useState)(40);(0,a.useEffect)((()=>{(async()=>{try{const t=await P.getPost(e.params.postId),n=await P.getPostComments(e.params.postId),o=await P.getCurrentUser();i(t),d(n),C(o)}catch(t){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438:",t)}finally{u(!1)}})()}),[e.params.postId]),(0,a.useEffect)((()=>{s.length>0&&v.current?.scrollToEnd({animated:!0})}),[s.length]),(0,a.useEffect)((()=>{const t=setInterval((async()=>{const t=await P.getPostComments(e.params.postId);d(t)}),1e3);return()=>clearInterval(t)}),[e.params.postId]);const T=async e=>{try{const t=[...s],n=t.findIndex((t=>t.idComment===e.idComment));if(-1===n)return;const o=t[n];o.likedByMe?(await P.unlikeComment(o.idComment),o.likes=Number(o.likes)-1,o.likedByMe=!1):(await P.likeComment(o.idComment),o.likes=Number(o.likes)+1,o.likedByMe=!0),d(t)}catch(t){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043b\u0430\u0439\u043a\u0430:",t)}};if(c)return(0,p.jsx)(h.default,{style:[ue.container,ue.centered],children:(0,p.jsx)(F.default,{size:"large",color:o.text})});const E=h.default;return(0,p.jsxs)(E,{style:ue.container,behavior:void 0,keyboardVerticalOffset:0,children:[(0,p.jsx)(re,{navigation:e.params.navigation,header:!0}),(0,p.jsx)(R.default,{ref:v,data:s,keyExtractor:(e,t)=>`${e.idComment||t}`,renderItem:({item:e})=>(0,p.jsx)(se,{comment:e,currentUser:b,toggleLike:T}),style:ue.mediaScroll,contentContainerStyle:{paddingBottom:20,maxHeight:.9*B.default.get("window").height},ListEmptyComponent:(0,p.jsx)(g.default,{style:ue.emptyText,children:"No comments yet."})}),x.length>0&&(0,p.jsx)(h.default,{style:{flexDirection:"row",flexWrap:"wrap",padding:8},children:x.map(((e,t)=>(0,p.jsx)(L.default,{source:{uri:e.uri},style:{width:80,height:80,margin:4,borderRadius:8}},t)))}),(0,p.jsxs)(h.default,{style:ue.inputContainer,children:[(0,p.jsx)(de.Avatar,{activeOpacity:.2,containerStyle:{backgroundColor:"#20C0B0"},icon:{name:"upload"},onPress:async()=>{const e=await O.launchImageLibraryAsync({mediaTypes:$.MediaTypeOptions.Images,quality:.7,base64:!0});if(!e.canceled){const t=e.assets?.[0];if(!t||!t.base64)return;const n=`data:image/jpeg;base64,${t.base64}`;S([{uri:n}])}},rounded:!0,size:"medium"}),(0,p.jsx)(j.default,{value:f,onChangeText:m,style:[ue.textInput,{height:k}],placeholder:"\u0412\u0430\u0448 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439...",placeholderTextColor:"#888",multiline:!0,onContentSizeChange:e=>I(Math.max(40,e.nativeEvent.contentSize.height))}),(0,p.jsx)(g.default,{children:"\u0410\u043d\u043e\u043d?"}),(0,p.jsx)(z.default,{value:w,onValueChange:y,style:{marginHorizontal:5}}),(0,p.jsx)(de.Avatar,{activeOpacity:.2,containerStyle:{backgroundColor:"#40E0D0"},icon:{name:"send"},onPress:async()=>{const e=f.trim();if(e||0!==x.length)try{const t=x[0]?.uri||null,n=await P.addCommentBase64({postId:r.idPost||r.id,content:e,isAnonymous:w,imageBase64:t});d((e=>[...e,n])),m(""),S([])}catch(t){console.error("\u274c \u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f:",t)}},rounded:!0,size:"medium"})]})]})}const ue=w.default.create({container:{flex:1,backgroundColor:"#fff",maxWidth:B.default.get("screen").width,maxHeight:B.default.get("screen").height},centered:{justifyContent:"center",alignItems:"center"},mediaScroll:{flex:1},inputContainer:{flexDirection:"row",padding:10,marginBottom:20,borderTopWidth:1,borderColor:"#ccc",backgroundColor:"#f9f9f9",alignItems:"center"},textInput:{flex:1,borderColor:"#ccc",borderWidth:1,borderRadius:10,paddingHorizontal:12,paddingVertical:8,marginRight:10,fontSize:15,backgroundColor:"#fff",color:"#000"},emptyText:{textAlign:"center",padding:20,color:"#888"}});var fe=n(6758);const he=w.default.create({container:{flex:1,padding:10},title:{fontSize:24,fontWeight:"bold",marginBottom:10},input:{borderWidth:1,padding:10,marginBottom:10,borderRadius:5},previewImage:{width:100,height:100,marginRight:10,marginBottom:10},error:{color:"red",marginBottom:10},postList:{marginTop:10},post:{marginBottom:10},postImage:{width:"100%",height:.9*B.default.get("window").width,borderRadius:5}});function ge({navigation:e}){const[t,n]=(0,a.useState)(""),[o,r]=(0,a.useState)([]),{current:i,colors:s}=(0,l.useSelector)((e=>e.theme)),d=s[i],[c,u]=(0,a.useState)([]),[f,w]=(0,a.useState)([""]),[y,x]=(0,a.useState)(null),[S,b]=(0,a.useState)(!1),[C,v]=(0,a.useState)(!1),k=(0,a.useRef)(null),[I,T]=(0,a.useState)(0),[E,F]=(0,a.useState)(0),z=(0,a.useRef)(null),[B,A]=(0,a.useState)(!1),D=()=>{f.length<4&&w([...f,""])},M=async(a=!1)=>{if(A(!0),t.trim()||0!==c.length)try{const i=f.filter((e=>e.trim())).map((e=>e.trim())),s=await Promise.all(c.map((async(e,t)=>{const n=await fetch(e.uri),o=await n.blob(),a=await new Promise((e=>{const t=new FileReader;t.onloadend=()=>e(t.result.split(",")[1]),t.readAsDataURL(o)})),r=e.mimeType?.split("/")[1]||"jpg";return{name:`${e.type}-${Date.now()}-${t}.${r}`,type:e.mimeType||"application/octet-stream",base64:a}}))),l={content:t.trim()||"",tags:i.join(","),isAnonymous:a,images:s},d=await P.addPost(l);return r([d,...o]),n(""),u([]),w([""]),x(null),e.navigate("Main"),d}catch(i){const e=i.message||"Failed to submit post";x(e),console.error("Error submitting post:",i)}else x("Content or media is required")};return(0,p.jsx)(fe.default,{behavior:"padding",style:{flex:1},keyboardVerticalOffset:20,children:(0,p.jsx)(H.default,{ref:z,style:{flex:1,backgroundColor:"black"},contentContainerStyle:{flexGrow:1,padding:10,paddingBottom:100},keyboardShouldPersistTaps:"handled",scrollEnabled:!0,children:(0,p.jsxs)(h.default,{children:[(0,p.jsx)(j.default,{ref:k,style:[he.input,{borderColor:d.border,color:d.text,height:C?E:80,minHeight:80,borderRadius:20}],placeholder:"What's on your mind?",value:t,onChangeText:e=>{e.length<=1e4&&n(e)},onContentSizeChange:e=>{const t=e.nativeEvent.contentSize.height;F(t),C||b(t>I)},onLayout:e=>{C||T(e.nativeEvent.layout.height)},placeholderTextColor:"#000"===d.text?"#666":"#ccc",numberOfLines:3,multiline:!0,scrollEnabled:!0}),S&&!C&&(0,p.jsx)(N.default,{onPress:()=>{v(!0),b(!1),setTimeout((()=>{z.current?.scrollToEnd({animated:!0})}),100)},style:{marginTop:5,padding:5,alignSelf:"flex-start"},children:(0,p.jsx)(g.default,{style:{color:"#000"===d.text?"#0066cc":"#4da8ff",fontSize:14,fontWeight:"500"},children:"Read More"})}),C&&(0,p.jsx)(N.default,{onPress:()=>{v(!1),b(E>I)},style:{marginTop:5,padding:5,alignSelf:"flex-start"},children:(0,p.jsx)(g.default,{style:{color:"#000"===d.text?"#0066cc":"#4da8ff",fontSize:14,fontWeight:"500"},children:"Read Less"})}),f.map(((e,t)=>(0,p.jsxs)(h.default,{style:{flexDirection:"row",alignItems:"center",marginBottom:10},children:[(0,p.jsx)(j.default,{style:[he.input,{borderColor:d.border,color:d.text,flex:1}],placeholder:`Tag ${t+1}`,value:e,onChangeText:e=>((e,t)=>{const n=[...f];n[e]=t,w(n)})(t,e),placeholderTextColor:"#000"===d.text?"#666":"#ccc"}),t===f.length-1&&f.length<4&&(0,p.jsx)(N.default,{onPress:D,style:{marginLeft:10,backgroundColor:"#4CAF50",padding:10,borderRadius:5},children:(0,p.jsx)(g.default,{style:{color:"white",fontSize:16},children:"+"})})]},t))),c.length>0&&(0,p.jsx)(R.default,{data:c,renderItem:({item:e})=>(0,p.jsx)(L.default,{source:{uri:e.uri},style:he.previewImage}),keyExtractor:(e,t)=>t.toString(),horizontal:!0,pagingEnabled:!0}),(0,p.jsx)(m.default,{title:"Pick Media",onPress:async()=>{const e=await O.launchImageLibraryAsync({mediaTypes:$.MediaTypeOptions.All,allowsMultipleSelection:!0,quality:.7,allowsEditing:!0});if(!e.canceled){const t=e.assets.map((e=>({uri:e.uri,type:"video"===e.type?"video":"image",mimeType:e.mimeType||("image"===e.type?"image/jpeg":"video/mp4")})));u([...c,...t])}}}),(0,p.jsx)(m.default,{title:"Post",disabled:B,onPress:()=>M(!1)}),(0,p.jsx)(m.default,{title:"Anon Post",disabled:B,onPress:()=>M(!0)})]})})})}const me=({navigation:e})=>(0,p.jsxs)(D.default,{style:{backgroundColor:"#000",flex:1},children:[(0,p.jsx)(re,{navigation:e,header:!0}),(0,p.jsx)(ge,{navigation:e})]});function we({navigation:e}){const t=(0,a.useRef)(new W.default.Value(0)).current;return(0,a.useEffect)((()=>{W.default.loop(W.default.sequence([W.default.timing(t,{toValue:1,duration:500,useNativeDriver:!0}),W.default.timing(t,{toValue:.5,duration:500,useNativeDriver:!0})]),{iterations:-1}).start();const n=setTimeout((()=>{e.replace("Main")}),2e3);return()=>clearTimeout(n)}),[t,e]),(0,p.jsxs)(h.default,{style:ye.container,children:[(0,p.jsx)(W.default.Image,{style:[ye.image,{opacity:t}],source:n(1277)}),(0,p.jsx)(g.default,{style:ye.text,children:"Open beta now!"})]})}const ye=w.default.create({container:{flex:1,backgroundColor:"#000000",justifyContent:"center",alignItems:"center"},image:{alignSelf:"center",alignItems:"center",width:100,height:100,marginBottom:20},text:{fontWeight:"bold",color:"#222",fontSize:18,marginBottom:20,alignSelf:"center",alignItems:"center"}});function pe({navigation:e}){const{current:t,colors:n}=(0,l.useSelector)((e=>e.theme)),o=n[t],[r,i]=(0,a.useState)({});return(0,a.useEffect)((()=>{P.getCurrentUser()})),(0,p.jsxs)(h.default,{style:[ee.container,{backgroundColor:o.background}],children:[(0,p.jsx)(re,{navigation:e,header:!0}),(0,p.jsx)(g.default,{style:[ee.header,{color:o.text}],children:"Profile"}),(0,p.jsx)(g.default,{style:{color:o.text,marginBottom:20},children:"Username: CurrentUser"})]})}const xe=(0,i.createStackNavigator)();"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("service-worker.js")})),(0,o.default)((function(){const e=(0,a.useRef)(null);return(0,p.jsx)(l.Provider,{store:f,children:(0,p.jsx)(s.GestureHandlerRootView,{style:{flex:1},children:(0,p.jsx)(r.NavigationContainer,{ref:e,children:(0,p.jsxs)(xe.Navigator,{initialRouteName:"Splash",children:[(0,p.jsx)(xe.Screen,{name:"Splash",component:we,options:{headerShown:!1}}),(0,p.jsx)(xe.Screen,{name:"Login",component:E,options:{headerShown:!1}}),(0,p.jsx)(xe.Screen,{name:"Main",component:ie,options:{headerShown:!1}}),(0,p.jsx)(xe.Screen,{name:"ProfileSettings",component:oe,options:{headerShown:!1}}),(0,p.jsx)(xe.Screen,{name:"Profile",component:pe,options:{headerShown:!1}}),(0,p.jsx)(xe.Screen,{name:"Settings",component:x,options:{headerShown:!1}}),(0,p.jsx)(xe.Screen,{name:"PostDetail",component:ce,options:{headerShown:!1}}),(0,p.jsx)(xe.Screen,{name:"CreatePost",component:me,options:{headerShown:!1}})]})})})})}))}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e,(()=>{var e=[];n.O=(t,o,a,r)=>{if(!o){var i=1/0;for(c=0;c<e.length;c++){for(var[o,a,r]=e[c],s=!0,l=0;l<o.length;l++)(!1&r||i>=r)&&Object.keys(n.O).every((e=>n.O[e](o[l])))?o.splice(l--,1):(s=!1,r<i&&(i=r));if(s){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[o,a,r]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var a,r,[i,s,l]=o,d=0;if(i.some((t=>0!==e[t]))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(l)var c=l(n)}for(t&&t(o);d<i.length;d++)r=i[d],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},o=self.webpackChunkweb=self.webpackChunkweb||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=n.O(void 0,[156],(()=>n(8895)));o=n.O(o)})();
//# sourceMappingURL=main.9e3bcd5a.js.map